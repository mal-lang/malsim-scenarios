# With seed 123:
# Passive Defender:                 -7310 reward after 480 steps
# BFS:                              -30177 reward after 398 steps
# DefendCompromisedDefender:        -9007 reward after 423 steps
# DefendFutureCompromisedDefender:  -15 reward after 2 steps

lang_file: ../../../langs/org.mal-lang.tyrLang-0.0.5.mar
model_file: demo3_beta-tyrlang_model.yml

rewards:
  ap01:read: 2
  ap01:fullAccess: 4
  ap01:deny: 3
  ap02:read: 2
  ap02:fullAccess: 4
  ap02:deny: 3
  ap03:read: 2
  ap03:fullAccess: 4
  ap03:deny: 3
  ap04:read: 2
  ap04:fullAccess: 4
  ap04:deny: 3
  ap05:read: 2
  ap05:fullAccess: 4
  ap05:deny: 3
  ap06:read: 2
  ap06:fullAccess: 4
  ap06:deny: 3
  ap07:read: 2
  ap07:fullAccess: 4
  ap07:deny: 3
  ap08:read: 2
  ap08:fullAccess: 4
  ap08:deny: 3
  ap09:read: 2
  ap09:fullAccess: 4
  ap09:deny: 3
  ap10:read: 2
  ap10:fullAccess: 4
  ap10:deny: 3
  ap11:read: 2
  ap11:fullAccess: 4
  ap11:deny: 3
  ap12:read: 2
  ap12:fullAccess: 4
  ap12:deny: 3
  ap13:read: 2
  ap13:fullAccess: 4
  ap13:deny: 3
  ap14:read: 2
  ap14:fullAccess: 4
  ap14:deny: 3
  ap15:read: 2
  ap15:fullAccess: 4
  ap15:deny: 3
  ap16:read: 2
  ap16:fullAccess: 4
  ap16:deny: 3
  ca:read: 1
  ca:fullAccess: 5
  ca:deny: 4
  dc:read: 1
  dc:fullAccess: 3
  dc:deny: 4
  files:read: 2
  files:fullAccess: 2
  files:deny: 4
  timereporter:read: 1
  timereporter:fullAccess: 3
  timereporter:deny: 5
  weborder:read: 1
  weborder:fullAccess: 4
  weborder:deny: 2
  ap01:notPresent: 3.7
  CR ap01-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap01:notPresent: 3.2
  ap02:notPresent: 3.7
  CR ap02-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap02:notPresent: 3.2
  ap03:notPresent: 3.7
  CR ap03-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap03:notPresent: 3.2
  ap04:notPresent: 3.7
  CR ap04-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap04:notPresent: 3.2
  ap05:notPresent: 3.7
  CR ap05-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap05:notPresent: 3.2
  ap06:notPresent: 3.7
  CR ap06-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap06:notPresent: 3.2
  ap07:notPresent: 3.7
  CR ap07-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap07:notPresent: 3.2
  ap08:notPresent: 3.7
  CR ap08-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap08:notPresent: 3.2
  ap09:notPresent: 3.7
  CR ap09-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap09:notPresent: 3.2
  ap10:notPresent: 3.7
  CR ap10-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap10:notPresent: 3.2
  ap11:notPresent: 3.7
  CR ap11-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap11:notPresent: 3.2
  ap12:notPresent: 3.7
  CR ap12-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap12:notPresent: 3.2
  ap13:notPresent: 3.7
  CR ap13-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap13:notPresent: 3.2
  ap14:notPresent: 3.7
  CR ap14-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap14:notPresent: 3.2
  ap15:notPresent: 3.7
  CR ap15-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap15:notPresent: 3.2
  ap16:notPresent: 3.7
  CR ap16-134.24.3.0/24:restricted: 3.4
  Admin Exec Identity - ap16:notPresent: 3.2
  ca:notPresent: 4.7
  CR ca-134.24.4.0/24:restricted: 4.4
  Admin Exec Identity - ca:notPresent: 4.2
  db:notPresent: 0.7
  CR db-134.24.4.0/24:restricted: 0.4
  Admin Exec Identity - db:notPresent: 0.2
  dc:notPresent: 4.7
  CR dc-134.24.4.0/24:restricted: 4.4
  CR payroll - dc:restricted: 4.4
  Admin Exec Identity - dc:notPresent: 4.2
  files:notPresent: 4.7
  CR files-134.24.4.0/24:restricted: 4.4
  Admin Exec Identity - files:notPresent: 4.2
  flightlogs:notPresent: 5.7
  CR flightlogs-134.24.4.0/24:restricted: 5.4
  Admin Exec Identity - flightlogs:notPresent: 5.2
  fw1:notPresent: 10000.7
  CR fw1-134.24.4.0/24:restricted: 10000.4
  CR fw1-134.24.17.0/24:restricted: 10000.4
  CR fw1-134.24.3.0/24:restricted: 10000.4
  CR fw1-134.24.2.0/24:restricted: 10000.4
  CR fw1-52.33.204.0/24:restricted: 10000.4
  Admin Exec Identity - fw1:notPresent: 10000.2
  mail:notPresent: 0.7
  CR mail-134.24.4.0/24:restricted: 0.4
  Admin Exec Identity - mail:notPresent: 0.2
  mailrelay:notPresent: 0.7
  CR mailrelay-134.24.2.0/24:restricted: 0.4
  Admin Exec Identity - mailrelay:notPresent: 0.2
  ns:notPresent: 0.7
  CR ns-134.24.2.0/24:restricted: 0.4
  Admin Exec Identity - ns:notPresent: 0.2
  ntp:notPresent: 0.7
  CR ntp-134.24.4.0/24:restricted: 0.4
  Admin Exec Identity - ntp:notPresent: 0.2
  payroll:notPresent: 0.7
  CR payroll-134.24.2.0/24:restricted: 0.4
  Admin Exec Identity - payroll:notPresent: 0.2
  print:notPresent: 0.7
  CR print-134.24.4.0/24:restricted: 0.4
  Admin Exec Identity - print:notPresent: 0.2
  snort-dmz:notPresent: 0.7
  CR snort-dmz-134.24.17.0/24:restricted: 0.4
  Admin Exec Identity - snort-dmz:notPresent: 0.2
  snort-ext:notPresent: 0.7
  CR snort-ext-134.24.17.0/24:restricted: 0.4
  Admin Exec Identity - snort-ext:notPresent: 0.2
  snort-hqclient:notPresent: 0.7
  CR snort-hqclient-134.24.17.0/24:restricted: 0.4
  Admin Exec Identity - snort-hqclient:notPresent: 0.2
  snort-srv:notPresent: 0.7
  CR snort-srv-134.24.17.0/24:restricted: 0.4
  Admin Exec Identity - snort-srv:notPresent: 0.2
  timereporter:notPresent: 5.7
  CR timereporter-134.24.2.0/24:restricted: 5.4
  Admin Exec Identity - timereporter:notPresent: 5.2
  weborder:notPresent: 2.7
  CR weborder-134.24.2.0/24:restricted: 2.4
  Admin Exec Identity - weborder:notPresent: 2.2

observable_steps:
  by_asset_type:
    ConnectionRule:
      - attemptConnectToApplications
      - attemptAccessNetworks
    Application:
      - fullAccess
      - notPresent
      - networkConnect
    Credentials:
      - attemptGuessCredentials

actionable_steps:
  by_asset_type:
    Application:
      - notPresent
    ConnectionRule:
      - restricted
    Identity:
      - notPresent

agents:
  'Attacker1':
    type: attacker
    entry_points:
      - 'flightlogs:fullAccess'
    agent_class: BreadthFirstAttacker

  'Defender1':
    type: 'defender'
    agent_class: 'DefendFutureCompromisedDefender'
